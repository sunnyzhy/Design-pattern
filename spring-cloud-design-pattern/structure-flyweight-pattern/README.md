# 享元模式（Flyweight）

## 定义

享元模式（Flyweight）又称为轻量级模式，是对象池的一种实现。类似于线程池，线程池可以避免不停地创建和销毁对象，消耗性能。提供了减少对象数量从而改善应用所需的对象结构的方式。其宗旨是共享细粒度对象，将多个对同一对象的访问集中起来，不必为每个访问者创建一个单独的对象，从此来降低内存的消耗。

总之，享元模式运用共享技术来有效地支持大量细粒度对象的复用。它通过共享已经存在的对象来大幅度减少需要创建的对象数量、避免大量相似类的开销，从而提高系统资源的利用率。

享元模式把一个对象的状态分为内部状态和外部状态：

- 内部状态指对象共享出来的信息，存储在享元对象内部且不会随环境的改变而改变。通过共享不变的部分，达到减少对象数量并节约内存的目的。
- 外部状态指对象得以依赖的一个标记，随环境的改变而改变、不可以共享。

享元模式的本质是缓存共享对象，降低内存消耗。

## 角色

- 抽象享元角色（Flyweight）：定义一个接口或者抽象类，为具体享元角色规范需要实现的公共接口，非享元的外部状态以参数的形式传入。
- 具体享元角色（Concrete Flyweight）：实现或继承抽象享元角色。
- 非享元角色（Unsharable Flyweight)：是不可以共享的外部状态，它以参数的形式注入具体享元的相关方法中。
- 享元工厂角色（Flyweight Factory）：负责管理享元对象池，创建和管理享元对象。当客户端请求一个享元对象时，享元工厂检査系统中是否存在符合要求的享元对象，如果存在，就提供给客户端；如果不存在，就创建一个新的享元对象并保存到享元对象池。

## 类图

![享元模式（Flyweight）](src/main/resources/static/diagram。png '享元模式（Flyweight）')

总结:

String 常量池、数据库连接池、缓冲池、线程池等等都是享元模式的应用，所以说享元模式是池技术的重要实现方式。
